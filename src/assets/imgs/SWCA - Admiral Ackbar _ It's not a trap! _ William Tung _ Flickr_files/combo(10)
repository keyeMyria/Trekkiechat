YUI.add("flickr-photosets-createHidden-creator",function(e,o){"use strict";e.namespace("ModelCreators")["flickr-photosets-createHidden"]={run:function(t,s){var r={},d=[];return r.photo_ids=t.photoIds,d=[s.callAPI("flickr.photosets.createHidden",r),s.getModelRegistry("set-models"),s.getModel("person-models",s.getViewer().nsid)],e.Promise.all(d).then(function(e){var o,t=e[0],s=e[1],r=e[2];return!("ok"!==t.stat||!t.photoset.share_code)&&(o={id:t.photoset.share_code,shareCode:t.photoset.share_code,owner:r,gpCode:t.photoset.share_code,gpOwner:r.getValue("pathAlias")||r.getValue("nsid"),url:t.photoset.url,isAutoUploadSet:!1,isSharedEntity:!0,totalCount:t.photoset.count},s.add(o),s.proxy(o.id))},e.FetcherErrorLogger(o))}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});YUI.add("flickr-photosets-editMeta-updater",function(e,t){"use strict";var o=require("hermes-core/flog")(t);e.namespace("ModelUpdaters")["flickr-photosets-editMeta"]={run:function(o,s){var i={},r=this;return i.photoset_id=o.photosetId,i.title=o.title,i.description=o.description,o.includeHiddenSets&&(i.extras="hidden_sets"),e.Promise.all([s.callAPI("flickr.photosets.editMeta",i),s.getModelRegistry("set-models")]).then(function(e){r._processResponse(e,o,s)},e.FetcherErrorLogger(t))},_processResponse:function(e,t,s){var i=e[0],r=e[1];if(i.photoset&&i.photoset.title&&i.photoset.description){if(!r.exists(t.photosetId))throw new Error("[flickr-photosets-editMeta-updater] - Set model cannot be updated if it does not exist");r.setValues(t.photosetId,{title:i.photoset.title.content,description:i.photoset.description.content})}else o.warn("No updated data returned from API.")}}},"@VERSION@",{requires:["flickr-promise"]});YUI.add("flickr-photosets-setPrimaryPhoto-updater",function(r,t){"use strict";r.namespace("ModelUpdaters")["flickr-photosets-setPrimaryPhoto"]={run:function(o,e){var s={};return s.photoset_id=o.albumId,s.photo_id=o.photoId,e.callAPI("flickr.photosets.setPrimaryPhoto",s).then(null,r.FetcherErrorLogger(t))}}},"@VERSION@",{requires:["flickr-promise"]});YUI.add("set-models",function(e,t){function o(e){o.superclass.constructor.call(this,e)}var r=require("hermes-core/flog")(t);e.Models[this.name]=o,e.extend(o,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photosets-getPhotos"].run(t,this.appContext)},create:function(t,o){return e.ModelCreators["flickr-photosets-create"].run(t,o)},createHidden:function(t,o){return e.ModelCreators["flickr-photosets-createHidden"].run(t,o)},addPhoto:function(t,o){return e.ModelCreators["flickr-photosets-addPhoto"].run(t,o)},removePhoto:function(t,o){return e.ModelCreators["flickr-photosets-removePhoto"].run(t,o)},update:function(t,o){return e.ModelUpdaters["flickr-photosets-editMeta"].run({photosetId:t,title:o.title?o.title.newVal:this.getValue(t,"title"),description:o.description?o.description.newVal:this.getValue(t,"description")},this.appContext)},setPrimaryPhoto:function(t,o){return e.ModelUpdaters["flickr-photosets-setPrimaryPhoto"].run(t,o)},delete:function(t){if("string"==typeof t){t={setID:t}}return e.ModelDeletors["flickr-photosets-delete-deletor"].run(t,this.appContext)}},addPhoto:function(e,t){return this.getValue(e,"photoPageList").hasMaxBoundary()&&this.getValue(e,"photoPageList").appendToList(t),this.getValue(e,"photoContextList").hasMaxBoundary()&&this.getValue(e,"photoContextList").appendToList(t),this},removePhoto:function(e,t){return this.getValue(e,"photoPageList").removeFromList(t.getValue("id")),this.getValue(e,"photoContextList").removeFromList(t.getValue("id")),this},hasPhoto:function(e,t){return this.getValue(e,"photoPageList").getFromListByID(t)||this.getValue(e,"photoContextList").getFromListByID(t)},getSizeToFit:function(t,o,i){r.warn("Using `getSizeToFit` is deprecated. See model comments for more details.");var n=e.PhotoModelHelper.getSizeToFit(t,o,e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0},i));return n&&(n.url=n.src),n},getLargestPrimaryPhotoSize:function(t,o){return e.PhotoModelHelper.getLargestSize(t,o)},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"set"}},title:{validator:function(t,o){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,o){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photosets-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photosets-getContext"],listItemIdField:"photoId"}},photoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},videoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},publicPhotosCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},totalCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return this.getValue(e,"photoCount")+this.getValue(e,"videoCount")}},viewCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},photoCountDisplay:{readOnly:!0,derivedBy:["totalCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),o=this.getValue(e,"videoCount"),r=this.getValue(e,"totalCount"),i="";return 0===(t-=o)&&0===o?i=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):1===t&&0===o?i=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&0===o?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):0===t&&1===o?i=this.intlMessage({intlName:"models.ONE_VIDEO"}):1===t&&1===o?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&1===o?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):0===t&&o>1?i=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:o}):1===t&&o>1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:o}):t>1&&o>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:o})),0===r?i=this.intlMessage({intlName:"models.ZERO_ITEMS"}):1===r?i=this.intlMessage({intlName:"models.ONE_ITEM"}):r>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_ITEMS",items:r})),i}},photoAndVideosDisplay:{readOnly:!0,derivedBy:["photoCount","videoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),o=this.getValue(e,"videoCount"),r="";return 0===t&&0===o?r=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):1===t&&0===o?r=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&0===o?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):0===t&&1===o?r=this.intlMessage({intlName:"models.ONE_VIDEO"}):1===t&&1===o?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&1===o?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):0===t&&o>1?r=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:o}):1===t&&o>1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:o}):t>1&&o>1&&(r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:o})),r}},sharedEntityDisplay:{readOnly:!0,derivedBy:["videoCount","photoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),o=this.getValue(e,"videoCount"),r=this.getValue(e,"owner"),i="";return t&&!o?i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_ONLY",username:r.getValue("displayname"),photoCount:parseInt(t,10)}):!t&&o?i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_VIDEOS_ONLY",username:r.getValue("displayname"),videoCount:parseInt(o,10)}):t&&o&&(i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_VIDEOS",username:r.getValue("displayname"),photoCount:parseInt(t,10),videoCount:parseInt(o,10)})),i}},primary:{},primaryPhotoSizes:{},primaryNeedsInterstitial:{},bestIconURL:{readOnly:!0,derivedBy:["primaryPhotoSizes"],defaultFn:function(t){var o=e.PhotoModelHelper.getSizeToFit(t,{height:75,width:75},e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0}));return o?o.src:""}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),o=this.getValue(e,"isSharedEntity"),r=this.getValue(e,"normalizedId");return t&&!0===o?"/photos/"+t.getValue("pathAlias")+"/shares/"+r:t?"/photos/"+t.getValue("pathAlias")+"/albums/"+r:void 0}},isAutoUploadSet:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isSharedEntity:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canShare:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},canDownload:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},urlSuffix:{readOnly:!0,defaultFn:function(e){return this.getValue(e,"isSharedEntity")?"shares-"+e:"album-"+e}},gpCode:{defaultFn:function(e){return null}},gpOwner:{defaultFn:function(e){return null}}}},{buildCompoundId:function(e,t,o){var r=e;return t&&(r+="-"+t),o&&(t||(r+="-dateposted"),r+="-"+o),r},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-addPhoto-creator","flickr-photosets-removePhoto-deletor","flickr-photosets-delete-deletor","flickr-photosets-getPhotos-fetcher","flickr-photosets-getContext-fetcher","flickr-photosets-create-creator","flickr-photosets-createHidden-creator","flickr-photosets-editMeta-updater","flickr-photosets-setPrimaryPhoto-updater","photo-model-helper"],langBundles:["models","shared-entity"]});YUI.add("photo-groups-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},groups:{isCollection:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});YUI.add("flickr-photos-getAllContexts-fetcher",function(e,t){"use strict";e.namespace("ModelFetchers")["flickr-photos-getAllContexts"]={run:function(o,s){var l=this;return s.flipper.isFlipped("enable-scrappy-photo-page")&&(o.scrappy=!0),e.Promise.all([s.callAPI("flickr.photos.getAllContexts",this._processParams(o),!0),s.getModelRegistry("person-models"),s.getModelRegistry("photo-contexts-models"),s.getModelRegistry("favorite-models"),s.getModelRegistry("gallery-models"),s.getModelRegistry("group-pool-models"),s.getModelRegistry("set-models"),s.getModelRegistry("photostream-models"),s.getModelRegistry("photo-groups-models"),s.getModelRegistry("photo-sets-models"),s.getModelRegistry("photo-galleries-models"),s.getModelRegistry("group-models")]).then(function(e){return l._processResponse(e,o)},e.FetcherErrorLogger(t))},_processParams:function(t){var o;return o={photo_id:t.id,extras:e.APIHelper.request.getRebootPhotoExtras()+","+e.APIHelper.request.getRebootGroupExtras()+","+e.APIHelper.request.getRebootAlbumsListExtras(),primary_photo_extras:"url_sq, url_t, url_s, url_m, needs_interstitial"},t.scrappy&&(o.get_all_galleries=1,o.no_faves_context=1,o.per_type_limit=6,o.get_totals=1,o.sort="date-desc"),o},_processResponse:function(t,o){var s,l,r=t[0],a=t[1],p=t[2],d={},i=[],g=t[8],n=t[9],u=t[10],m=t[11];return d.faves=t[3],d.gallery=t[4],d.pool=t[5],d.set=t[6],d.stream=t[7],e.Object.each(d,function(t,o){r[o]&&e.Array.each(r[o],function(o){e.APIHelper.response.addContextToRegistry(o,t,a,m),i.push(t.proxy(o.id))})}),p.exists(o.id)||(s=p.add({id:o.id,totalGroups:r.totals&&r.totals.groups,totalSets:r.totals&&r.totals.sets,totalGalleries:r.totals&&r.totals.galleries}),p.setValue(o.id,"contexts",i)),g.addOrUpdate({id:o.id,total:r.totals&&r.totals.groups,groups:p.getContextsOfType(o.id,"group-pool-models")}),(l=p.getContextsOfType(o.id,"set-models")).forEach(function(e){e.setValue("totalCount",parseInt(e.getValue("photoCount"),10)+parseInt(e.getValue("videoCount"),10))}),n.addOrUpdate({id:o.id,total:r.totals&&r.totals.sets,sets:l}),u.addOrUpdate({id:o.id,total:r.totals&&r.totals.galleries,galleries:p.getContextsOfType(o.id,"gallery-models")}),s}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-contexts-models","favorite-models","gallery-models","group-pool-models","photostream-models","set-models","photo-groups-models","photo-sets-models","photo-galleries-models","group-models"]});YUI.add("photo-contexts-models",function(e){function t(e){t.superclass.constructor.call(this,e),this.getMorePromises={"group-pool-models":{},"set-models":{},"gallery-models":{}},this.continuationKeys={"group-pool-models":{},"set-models":{},"gallery-models":{}}}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return this.appContext.flipper.isFlipped("enable-scrappy-photo-page")?e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext):e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},getMoreContextsOfType:function(t,r,o){var s,n,i,l,a,p,u,c=this,g=e.APIHelper.request.getRebootPhotoExtras();switch(r){case"group-pool-models":s="flickr.photos.getGroups",i="groups.group",g+=","+e.APIHelper.request.getRebootGroupExtras();break;case"set-models":s="flickr.photos.getSets",i="sets.set";break;case"gallery-models":s="flickr.photos.getGalleries",i="galleries.gallery"}return s?this.exists(t)?"-1"===(l=this.continuationKeys[r][t]||"0")?e.Promise.resolve({type:r,newContexts:[],loadedAll:!0}):(n={photo_id:t,extras:g,primary_photo_extras:"url_sq, url_t, url_s, url_m",continuation:l,per_page:o},p=t+"_"+l,(u=this.getMorePromises[r][p])?u:(this.getMorePromises[r][p]=new e.FlickrPromise({apiResponse:this.appContext.callAPI(s,n,!0),contextRegistry:this.appContext.getModelRegistry(r),personRegistry:this.appContext.getModelRegistry("person-models")}).then(function(o){var s,n,l,u=[],g=o.apiResponse,d=o.contextRegistry,f=o.personRegistry;return(n=i.split(".").reduce(function(t,r){return e.Lang.isObject(t)?t[r]:void 0},g))&&(e.Array.each(n,function(t){e.APIHelper.response.addContextToRegistry(t,d,f),u.push(d.proxy(t.id))}),u.length&&(l=c.getContextsOfType(t,r).map(function(e){return e.getValue("id")}),(u=u.filter(function(e){return-1===l.indexOf(e.getValue("id"))})).length&&c.getValue(t,"contexts").appendToListMulti(u))),void 0===(a=g.continuation)?a="-1":e.Lang.isNumber(a)&&(a+=""),s="-1"===a,c.continuationKeys[r][t]=a,delete c.getMorePromises[r][p],{type:r,newContexts:u,loadedAll:s}}),this.getMorePromises[r][p])):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called for an ID that isn't in the registry: "+t):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called without an invalid type: "+r)},getContextsOfType:function(t,r){return r=e.Array(r),this.getValue(t,"contexts").getList().filter(function(e){return r.indexOf(e.registry.name)>-1})},getContextsNotOfType:function(t,r){return r=e.Array(r),this.getValue(t,"contexts").getList().filter(function(e){return-1===r.indexOf(e.registry.name)})},attributes:{contexts:{isCollection:!0},totalGroups:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalSets:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalGalleries:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","flickr-photos-getAllContexts-fetcher"]});YUI.add("vr-overlay-view",function(e,t){var i,n=require("hermes-core/flog")(t);i={css:{destinationContainer:"body",closeX:".close"},options:{}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.nsid=e.nsid,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.immersed=!1,this},subviewConfig:{},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){return e.set("photo",t),e.canVr().then(function(t){e.set("canVr",t)})})},buildContainer:function(){var e=this.get("canVr");return this.set("isActiveViewAgnostic",!0),e?(this.setContainerWithTemplate("vr-overlay"),this):this},buildErrorContainer:function(){this.setContainerHTML("")},activate:function(){var t=this;if(this.get("canVr"))return this.loadFlickvr().then(function(){var n=t.get("container");n.addClass("active"),n.one(i.css.closeX)&&t.registerEventHandler(n.one(i.css.closeX).on("click",e.bind(t.closeVr,t))),t.registerEventHandler(t.get("container").on("click",t.openVr,t)),t.isMobile||t.openVr()}).then(null,function(e){n.error("Failed to load flickvr from CDN",{err:e})}),this},loadFlickvr:function(){return new e.Promise(function(t,i){if(window.Flickvr)return t();e.Get.js("https://s.yimg.com/uy/flickvr/version.js",function(r){return r?i():window.FlickvrVersion?void e.Get.js("https://s.yimg.com/uy/flickvr/"+window.FlickvrVersion+".js",function(e){return e?i():(n.log("flickvr loaded successfully from CDN"),t())}):i()})})},hasEquirectangularTag:function(){return this.appContext.getModel("photo-tags-models",this.photoId).then(function(e){var t=!1;return e.toJSON().tags.forEach(function(e){"equirectangular"===e.tagRaw.toLowerCase()&&(t=!0)}),t})},inEquirectangularGroup:function(){return this.appContext.getModel("photo-groups-models",this.photoId).then(function(e){var t=!1;return e.toJSON().groups.forEach(function(e){"44671723@N00"===e.id&&(t=!0)}),t})},canVr:function(){var t,i,n=!1;return this.appContext.flipper.isFlipped("enable-vr")?((t=this.get("photo"))&&(i=t.getValue("aspectRatio"))&&i>=1.99&&i<=2.01&&(n=!0),n?e.Promise.all([this.appContext.callAPI("flickr.vr.isEquirectangular",{photo_id:t.id})]).then(function(t){return e.Promise.resolve(!!t[0].is_equirectangular)}):e.Promise.resolve(!1)):e.Promise.resolve(!1)},onParentViewEvent:function(e,t){if(t&&t[0])switch(t[0]){case"vrIconClicked":this.openVr();break;case"vKeyPressed":this.toggleVr()}},toggleVr:function(){this.immersed?this.closeVr():this.openVr()},openVr:function(t){if(this.immersed||t&&t.target.hasClass("close"))this.vr.controls&&this.vr.controls.autoRotate&&(this.vr.controls.autoRotate=!1);else{var i,n,r=this,o=this.get("photo").getLargestSize(),s=this.templates("flickr-balls")({}),a=new Image;t&&t.halt(),(n=e.Node.create("<div></div>")).addClass("vr-loading-layer"),n.addClass("fluid"),n.append(s),r.get("container").append(n),i=o.displayUrl.replace("staticflickr","static.flickr"),a.crossOrigin="anonymous",a.onload=function(){r.immersed=!0,r.vr=new window.Flickvr,r.vr.initialize(i,{container:r.get("container").getDOMNode(),useContainerDimensions:!r.isMobile,enableVrHeadset:r.appContext.flipper.isFlipped("enable-vr-headset"),autoRotate:!r.isMobile}).then(function(t){e.fire("photo:entering-vr"),t.style.position="absolute",r.vr.enterVR(),r.get("container").one(".vr-loading-layer").remove(),r.get("container").addClass("immersed"),r.escHandle=r.attachKeyEvent("down:27",e.betterThrottle(r.closeVr.bind(r),100))})},a.src=i}},closeVr:function(e){var t=this.get("container");e&&e.preventDefault(),this.vr&&this.vr.destroy(),this.escHandle&&(this.detachRegisteredEvent(this.escHandle),delete this.escHandle),this.immersed=!1,t.removeClass("immersed")},beforeDestroy:function(){this.set("lastContainer",this.get("container")),this.immersed&&this.closeVr()},destructor:function(){var e=this.get("lastContainer");e&&(e.remove(!0),this.set("lastContainer",null))}})},"@VERSION@",{requires:["flickr-view","better-throttle","get","hermes-template-vr-overlay","hermes-template-flickr-balls"],optional:["photo-models","photo-tags-models","photo-groups-models"],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-lang-photo-page-scrappy_es-us",function(a,e){a.Intl.add("hermes/photo-page-scrappy","es-US",{PAGE_TITLE:["${title}"," | Flickr"],BACK_TO:["Volver a ","${entryType}"],COULDNT_UPDATE_SETTINGS:["No pudimos actualizar tus ajustes"],ADULT_CONTENT:["Contenido para adultos"],MATURE_AUDIENCES:["Este contenido es sólo para adultos."],USER_DISCRETION:["Se recomienda discreción."],SHOW_ME_THIS_CONTENT_TYPE:["De ahora en adelante, mostrarme este tipo de contenido"],CHANGE_SAFE_SEARCH_IN_SETTINGS:['Siempre podrás cambiar las <a href="/account/prefs/safesearch/?from=privacy"  data-track="photoWellSafeSearchClick">configuraciones de Búsqueda segura</a> en las preferencias de tu cuenta.'],SIGNED_IN_FOR_CONTENT:["Debes iniciar sesión para ver este contenido."],VIDEO_COMING_SOON:["Pronto estará disponible el soporte de videos"],FIND_OUT_MORE_AD:["Descubre más en ","${brand}"],SHARE_THIS_PHOTO:["Compartir esta foto"],DOWNLOAD_THIS_VIDEO:["Descargar este video"],DOWNLOAD_THIS_PHOTO:["Descargar esta foto"],VIEW_ALL_SIZES:["Ver todos los tamaños"],DOWNLOAD_PHOTO:["Descargar foto"],SOME_RIGHTS_RESERVED:["Algunos derechos reservados"],DOWNLOAD:["Descargar"],ERROR_LOADING_CONTEXT:["Error al cargar el contexto"],ADD_TITLE:["Añadir título"],ADD_DESCRIPTION:["Añadir descripción"],TITLE_DESCRIPTION_FAILURE:["En este momento no pudimos cambiar el título y la descripción."],VIEW_PREVIOUS_COMMENT:["Ver el comentario anterior"],VIEW_MORE_PREVIOUS_COMMENTS:["Ver ","${count}"," comentarios previos"],EMPTY_COMMENT_ERROR:["¿Un cuadro de comentarios vacío? ¡Eso no funcionará!"],COMMENT_RATE_LIMIT_ERROR:["¡Bájale, amigo! Para proteger a la comunidad Flickr contra el spam y contra comportamientos que parece spam, implementamos unas cuantas restricciones en los comentarios."],COMMENT_POST_ERROR:["No pudimos publicar tu comentario."],MORE_COMMENTS_ERROR:["No pudimos obtener más comentarios."],COMMENT_PERMALINK_ERROR:["No pudimos encontrar el comentario especificado en esta foto."],DELETE_COMMENT:["Eliminar comentario"],COMMENT_DELETE_CONFIRMATION:["¿Estás seguro que deseas eliminar este comentario?"],COMMENT_DELETE_ERROR:["No pudimos eliminar tu comentario."],COMMENT_LOADING_ERROR:["Error al cargar comentarios"],COMMENT:["Comentar"],SHOW_MORE_COMMENTS:["${count}"," más"],REPLY:["Responder"],PERMALINK:["Enlace permanente"],SINGLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAlias}",'/">',"${displayName}","</a> marcó esto como favorito"],DOUBLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a> y <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}","</a> marcaron esta foto como favorito"],TRIPLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a> y <a class="faved-by-person-link" href="/photos/',"${pathAliasThree}",'/">',"${displayNameThree}","</a> marcaron esta foto como favorito"],MULTI_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a> y <a class="remaining-faved-by" href="#">',"${count}"," personas más</a> marcaron esta foto como favorito"],RELATIONSHIP_FRIEND_ERROR:["Ocurrió un error al ajustar la relación con tu amigo."],RELATIONSHIP_FAMILY_ERROR:["Hubo un problema al configurar la relación con tu familia."],HIDE_EXIF:["Ocultar EXIF"],SHOW_EXIF:["Mostrar EXIF"],EDIT_LOCATION:["Editar lugar"],EDIT_LOCATION_ORGANIZR:["Estamos trabajando duro para rediseñar nuestra experiencia fotográfica nueva. A partir de ahora, puedes Editar ubicación en Organizr."],SAVE_LOCATION:["Guardar ubicación"],APERTURE:["Apertura"],FOCAL_LENGTH:["Distancia focal"],EXPOSURE_TIME:["Tiempo de exposición"],FLASH_AUTO_FIRED:["Flash (auto, disparó)"],FLASH_AUTO_NO_FIRE:["Flash (auto, no disparó)"],FLASH_ON_FIRED:["Flash (encendido, disparó)"],FLASH_ON_NO_FIRE:["Flash (encendido, no disparó)"],FLASH_OFF:["Flash (apagado, no disparó)"],FLASH_SIMPLE_ON:["Activada"],FLASH_SIMPLE_OFF:["Desactivada"],POWERED_BY:["IMPULSADO POR"],FOURSQUARE:["FOURSQUARE"],ADD_PHOTO_TO_MAP:["Añadir esta foto a tu mapa"],SINGULAR_FAVE:["favorito"],PLURAL_FAVE:["favoritos"],SINGULAR_VIEW:["visita"],PLURAL_VIEW:["visitas"],SINGULAR_COMMENT:["comentario"],PLURAL_COMMENT:["comentarios"],LICENSE_ERROR:["Ocurrió un error al cambiar la licencia de tu foto"],ALL_RIGHTS_RESERVED:["Todos los derechos reservados"],NO_RESTRICTIONS:["Sin restricciones de derechos de autor conocidas"],PUBLIC_DOMAIN:["Dominio público"],USA_GOV_WORK:["Trabajo del gobierno de los Estados Unidos"],SAFETY_CHANGE_ERROR:["Ocurrió un error al cambiar el nivel de seguridad de tu foto."],PRIVACY_CHANGE_ERROR:["Ocurrió un error al cambiar la privacidad de tu foto"],COMMENT_PERM_CHANGE_ERROR:["Ocurrió un error al cambiar los permisos para comentar tu foto"],FLAG_PHOTO:["Denunciar esta foto"],MARK_FOR_REVIEW:["Marcar para revisión"],ADDITIONAL_INFO:["Información adicional"],VIEWING_THIS_PHOTO:["Quién puede ver esta foto"],PRIVACY_UPDATE_ERROR:["Ocurrió un error al actualizar la privacidad. Vuelve a intentarlo por favor."],META_PERMS_UPDATE_ERROR:["Ocurrió un error al actualizar los permisos para añadir metadatos. Vuelve a intentarlo."],ADD_META_TO_THIS_PHOTO:["Añadir etiquetas y personas a esta foto"],COMMENT_PERMS_UPDATE_ERROR:["Ocurrió un error al actualizar los permisos de comentarios. Vuelve a intentarlo por favor."],COMMENTING_ON_THIS_PHOTO:["Comentando sobre esta foto"],SAFETY_UPDATE_ERROR:["Ocurrió un error al actualizar el nivel de privacidad. Vuelve a intentarlo por favor."],SAFETY_LEVEL_OF_PHOTO:["Nivel de seguridad de esta foto"],FLAG_ERROR:["Ocurrió un error al tratar de marcar esta foto. Vuelve a intentarlo por favor."],PROVIDE_FEEDBACK:["Danos tu opinión sobre la nueva página de fotos"],ERROR_DELETING_AUTOTAG:["Erro al borrar la Etiqueta automática"],AUTOTAGS:["Etiquetas automáticas"],CONTACT_LIST_ERROR:["Ocurrió un error al tratar de obtener tu lista de contactos. Vuelve a intentarlo por favor."],FAILED_TO_REMOVE_PERSON:["En este momento no se pudo quitar a esa persona de la foto."],PERSON_CANNOT_BE_TAGGED:["No se pudo etiquetar a esta persona."],PEOPLE_IN_PHOTO:["Gente en la foto"],ADD_PEOPLE:["Añadir personas"],ADD_PERSON:["Añadir persona"],ERROR_REMOVING_FROM_GROUP:["Hubo un problema al quitar esta foto del grupo"],ERROR_ACCEPTING_INVITATION:["Hubo un problema al aceptar la invitación del grupo"],SEARCH_GROUPS:["Buscar grupos"],PHOTO_NOT_IN_GROUPS:["En este momento esta foto no está en ningún grupo"],ADD_TO_GROUP:["Añadir a un grupo"],INVITE_TO_GROUP:["Invitar al grupo"],ONE_GROUP_INVITATION:["Tienes 1 invitación a un grupo"],N_GROUP_INVITATIONS:["Tienes ","${count}"," invitaciones a un grupo"],VIEW_MORE_GROUPS:["Ver más grupos"],ERROR_REMOVING_FROM_ALBUM:["Hubo un problema al quitar esta foto del álbum"],WARNING_REMOVE_LAST_PHOTO_FROM_ALBUM:["Estás a punto de quitar la última foto de un álbum lo que borrará el álbum."],REMOVE_PHOTO_AND_ALBUM:["Quitar la foto y borrar el álbum"],ADD_PHOTO_TO_ALBUM:["Añadir esta foto a un álbum"],SEARCH_ALBUMS:["Buscar álbumes"],ADD_TO_ALBUM:["Añadir a un álbum"],PHOTO_NOT_IN_ALBUMS:["En este momento esta foto no está en ningún álbum"],VIEW_MORE_ALBUMS:["Ver más álbumes"],PHOTO_IN_ONE_ALBUM:["Esta foto está en 1 álbum"],PHOTO_IN_N_ALBUMS:["Esta foto está en ","${count}"," álbumes"],INVITE_PENDING:["Invitación pendiente"],CANCEL_INVITE:["Cancelar invitación"],ACCEPT_INVITE:["Aceptar invitación"],ONE_ITEM:["1 elemento"],N_ITEMS:["${count}"," elementos"],ERROR_REMOVING_FROM_GALLERY:["Hubo un problema al quitar esta foto de la galería"],SEARCH_GALLERIES:["Buscar galerías"],ADD_TO_GALLERY:["Añadir a una galería"],PHOTO_NOT_IN_GALLERIES:["En este momento esta foto no está en ningúna galería"],VIEW_MORE_GALLERIES:["Ver más galerías"],PHOTO_IN_ONE_GALLERY:["Esta foto está en 1 galería"],PHOTO_IN_N_GALLERIES:["Esta foto está en ","${count}"," galerías"],DELETE_PHOTO:["Eliminar foto"],PERMANTENTLY_DELETE:["¿Quieres eliminar permanentemente esta foto?"],EDIT_PHOTO:["Editar foto"],NO_VIDEO_ROTATION:["No se pudieron girar los videos"],ROTATE:["Girar"],NO_VIDEO_REPLACE:["No se pudieron reemplazar los videos"],REPLACE:["Reemplazar"],PHOTO_NAVIGATION:["Navegación de la foto"],THUMBNAIL_NAVIGATION:["Navegación en la vista miniatura"],ZOOM:["Acercar/Alejar"],VIEW_IN_LIGHTBOX:["Ampliar foto"],BACK_TO_CONTEXT:["Volver al contexto"],ADD_TAG:["Añadir etiqueta"],GO_TO_ORGANIZER:["Ir a Organizr"],ALBUM:["álbum"],ALBUMS:["álbumes"],ERROR_LOADING_ALBUMS:["Hubo un problema al cargar tus álbumes"],ERROR_ADDING_PHOTO_TO_ALBUM:["Hubo un problema al añadir esta foto al álbum"],ERROR_REMOVING_PHOTO_FROM_ALBUM:["Hubo un problema al quitar esta foto del álbum"],ERROR_LOADING_GROUPS:["Hubo un problema al cargar los grupos en los que puedes colocar fotos"],ERROR_ADDING_TO_GROUP:["Hubo un problema al añadir esta foto en el grupo"],ERROR_ADDING_TO_GROUP_NOT_OWNER:["Lo sentimos, la foto no se puedo agregar al grupo porque la foto no te pertenece."],ERROR_ADDING_TO_GROUP_NOT_MEMBER:["Lo sentimos, la foto no se pudo agregar al grupo. No eres miembro del grupo."],ERROR_ADDING_TO_GROUP_ALREADY_IN_POOL:["La foto ya se encuentra en ese conjunto del grupo."],ERROR_ADDING_TO_GROUP_MAX_POOLS:["Lo sentimos, la foto no se pudo agregar al grupo porque ya se alcanzó la cantidad máxima de conjuntos del grupo."],ERROR_ADDING_TO_GROUP_MAX_PHOTOS_FROM_USER:["Lo sentimos, la foto no se pudo agregar al grupo. Ya has agregado la cantidad máxima de fotos al conjunto."],ERROR_ADDING_TO_GROUP_ADDED_TO_QUEUE:["Tu foto se ha agregado a la cola pendiente para el grupo."],ERROR_ADDING_TO_GROUP_ALREADY_IN_QUEUE:["Tu foto ya está en la cola pendiente para el grupo."],ERROR_ADDING_TO_GROUP_INVALID_CONTENT:["Lo sentimos, la foto no se pudo agregar al grupo. Para obtener más información, verifica los requisitos del grupo con respecto al tipo de medios, al tipo de contenido, al nivel de seguridad y a la ubicación geográfica."],ERROR_ADDING_TO_GROUP_MAX_IN_POOL:["Lo sentimos, la foto no se pudo agregar al grupo. El grupo tiene la cantidad máxima de fotos permitidas en un conjunto."],ERROR_INVITING_TO_GROUP:["Hubo un problema al invitar esta foto al grupo"],ERROR_CANCELING_GROUP_INVITIATON:["Hubo un problema al cancelar la invitación de esta foto al grupo"],NO_MATCHES:["No se encontraron resultados"],CREATE_NEW:["Crear nuevo"],ERROR_LOADING_GROUP_INVITATIONS:["Hubo un problema al cargar las invitaciones del grupo de esta foto"],NO_GROUP_INVITATIONS:["No hay invitaciones de grupo pendientes"],PENDING_INVITATIONS_FOR_PHOTO:["Invitaciones pendientes de esta foto"],LOADING_INVITATIONS:["Cargando invitaciones"],ERROR_LOADING_GALLERIES:["Hubo un problema al cargar tus galerías"],ERROR_ADDING_TO_GALLERY:["Hubo un problema al añadir esta foto en la galería"],ERROR_PHOTO_NOT_ALLOWED_IN_GALLERY:["El propietario de esta foto no permite que la foto se añada a tu galería"],ERROR_CREATING_GALLERY:["Ocurrió un problema al crear tu galería nueva"],DATE_TAKEN_FORMAT:["La fecha en que se tomó la foto debe tener el formato MM/DD/AAAA hh:mm:ss."],DATE_POSTED_FUTURE:["La fecha de publicación no puede ser en el futuro."],DATE_UPLOADED_FUTURE:["La fecha de subida no puede ser en el futuro."],DATE_POSTED_FLICKR_JOIN:["La fecha de publicación debe ser después de que te uniste a Flickr."],DATE_UPLOADED_FLICKR_JOIN:["La fecha de subida debe ser después de que te uniste a Flickr."],ERROR_SAVING_DATE:["Error al guardar las fechas"],DATE_INVALID:["Una o más fechas son inválidas"],EDIT_DATES:["Editar fechas"],DATE_TAKEN_ON:["Fecha en que se tomó"],DATE_POSTED_ON:["Fecha en que se publicó"],DATE_UPLOADED_ON:["Fecha de subida:"],TAKEN_CIRCA:["Tomada circa ","${intlDate}"],TAKEN_SOMETIME_IN:["Tomada en algún momento durante ","${intlDate}"],TAKEN_IN:["Tomada en ","${intlDate}"],TAKEN_ON:["Tomada el ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON:["Subida el ","${intlDate}"],SOMETHING_WENT_WRONG:["Algo salió mal."],REFRESH_BROWSER:["Actualiza tu navegador e inténtalo nuevamente."],TWITTER_NOT_FOUND:["No se encontró la cuenta de Twitter en la publicación"],TUMBLR_NOT_FOUND:["No se encontró la cuenta de Twitter en la publicación"],LINK:["Enlace"],LINK_TO_VIDEO:["Enlace hacia este video:"],LINK_TO_PHOTO:["Enlace hacia esta foto:"],NO_LINKS_FOR_RESTRICTED_VIDEO:["Los enlaces no están disponibles para videos restringidos"],PRIVATE_VIDEO_SHARE:["Este es un video privado ¿Todavía quieres compartirlo?"],NO_LINKS_FOR_RESTRICTED_PHOTO:["Los enlaces no están disponibles para fotos restringidas"],PRIVATE_PHOTO_SHARE:["Esta es una foto privada ¿Todavía quieres compartirla?"],SHARING_RESTRICTED_VIDEO:["No se puede Compartir este video"],SHARING_RESTRICTED_PHOTO:["No se puede Compartir esta foto"],EMBED:["Insertar"],PUBLIC_TO_SHARE:["Para ver el código incrustado, comparte esta foto"],SIZE:["Tamaño:"],TITLE_AND_OWNER_AT_START:["Mostrar título y propietario al inicio"],SHARE_NOW:["¡Mostrar ahora!"],SHARE_PHOTO:["Compartir foto"],SHARE_ON_TWITTER:["Compartir en Twitter"],AUTHORIZE_FOR_TWITTER:["por favor autoriza que Flickr pueda publicar en Twitter"],SHARE_ON_TUMBLR:["Compartir en Tumblr"],PUBLISH_NOW:["Publicar ahora"],ADD_TO_QUEUE:["Añadir a la cola"],SAVE_AS_DRAFT:["Guardar como borrador"],AUTHORIZE_FOR_TUMBLR:["por favor autoriza que Flickr pueda publicar en Tumblr"],SHARE_VIA_MAIL:["Compartir por correo"],SCREEN_NAME_OR_EMAIL:["Nombre en pantalla o correo electrónico"],SQUARE:["Cuadrado"],SMALL:["Pequeña"],MEDIUM:["Mediana"],LARGE:["Grande"],ORIGINAL:["Original"],DUPLICATE_TAG:["Duplicar etiqueta"],INVALID_TAG:["Etiqueta inválida"],MAXIMUM_TAG_LIMIT:["Se alcanzó el límite máximo (76) de etiquetas"],MAX_TAG_LIMIT:["Se alcanzó el límite máximo (75) de etiquetas"],ERROR_ADDING_TAG:["Error al añadir la etiqueta"],ERROR_DELETING_TAG:["Error al borrar la etiqueta"],TAGS:["Etiquetas"],ADD_TAGS:["Añadir etiquetas"],ADD_A_TAG:["Añadir etiqueta"],PHOTO_IN_ONE_GROUP:["Esta foto está en 1 grupo"],PHOTO_IN_MANY_GROUPS:["Esta foto está en ",{type:"number",valueName:"count"}," grupos"],PHOTO_IN_NO_GROUPS:["Esta foto no está en ningún grupo"],ADD_A_COMMENT:["Añadir comentario"],COMMENT_TUTORIAL:["presiona 'Entrar' para publicar y Mayúsculas+Entrar para agregar una línea nueva"],SIGNED_IN_TO_POST_A_COMMENT:["Debes iniciar sesión para publicar un comentario"],SHARE:["Compartir"],CODE:["Código"],INCLUDE_A_MESSAGE:["Incluye un mensaje"],FOR_MORE_INFORMATION_SAFESEARCH:['Para obtener más información consulta <a href="//www.flickr.com/help/photos/?search=flag#145">estas Preguntas frecuentes</a>.'],FLAG_CONFIRMATION_SAFE_WITHIN:['Esta foto está marcada como <a href="//www.flickr.com/help/filters/#258">segura</a> coincide con tus criterios de <a href="//www.flickr.com/account/prefs/safesearch/">Búsqueda segura</a>.'],FLAG_CONFIRMATION_SAFE_OUTSIDE:['Esta foto está marcada como <a href="//www.flickr.com/help/filters/#258">segura</a> y no entra en tus ajustes de <a href="//www.flickr.com/account/prefs/safesearch/">búsqueda segura</a>.'],FLAG_CONFIRMATION_MODERATE_WITHIN:['Esta foto está marcada como <a href="//www.flickr.com/help/filters/#258">moderada</a> coincide con tus criterios de <a href="//www.flickr.com/account/prefs/safesearch/">Búsqueda segura</a>.'],FLAG_CONFIRMATION_MODERATE_OUTSIDE:['Esta foto está marcada como <a href="//www.flickr.com/help/filters/#258">moderada</a> y no entra en tus ajustes de <a href="//www.flickr.com/account/prefs/safesearch/">Búsqueda segura</a>.'],FLAG_CONFIRMATION_RESTRICTED_WITHIN:['Esta foto está marcada como <a href="//www.flickr.com/help/filters/#258">restringida</a> coincide con tus criterios de <a href="//www.flickr.com/account/prefs/safesearch/">búsqueda segura</a>.'],FLAG_CONFIRMATION_RESTRICTED_OUTSIDE:['Esta foto está marcada como <a href="//www.flickr.com/help/filters/#258">restringida</a> y no entra en tus ajustes de <a href="//www.flickr.com/account/prefs/safesearch/">búsqueda segura</a>.'],PRIVATE_PHOTO:["Foto privada"],PHOTO_UNFIT_FOR_YOUR_EYES:["Esta foto no es apta para tus ojos. Te damos un gatito: (^._.^)ﾉ"],NO_PHOTO_WITH_THAT_ID:["No se encontró una foto con el id ","${photoId}"],NO_MEMBERS_FOUND:["No se encontraron miembros"],TAKEN_ON_INTL:["Tomada el ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON_INTL:["Subida el ",{type:"date",valueName:"intlDate",format:"long"}],TAKEN_IN_MONTH:["Tomada en ",{type:"date",valueName:"intlDate",format:"monthYear"}],VIEW_IN_LIGHTBOX_SHORTCUT:["Ver en caja de luz"],ZOOM_MAX_MESSAGE:["¡Espera, no te emociones! Esta foto ya llegó al máximo de su tamaño."],CLICK_TO_FAVE_PHOTO:["Hacer clic aquí para marcar esta foto como favorita"],CLICK_TO_FAVE_VIDEO:["Hacer clic aquí para marcar este video como favorito"],BACK_TO_ACTIVITY_FEED:["Regresar a la fuente de actividades"],BACK_TO_PHOTOSTREAM:["Regresar a la galería"],BACK_TO_SHARED_PHOTOS:["Volver a fotos compartidas"],BACK_TO_ALBUM:["Regresar al álbum"],BACK_TO_CONTACTS_LIST:["Regresar a la lista de contactos"],BACK_TO_FAVORITES:["Regresar a favoritos"],BACK_TO_GALLERY:["Regresar a la expo"],BACK_TO_PROFILE:["Regresar al perfil"],BACK_TO_EXPLORE:["Regresar a la exploración"],BACK_TO_COMMONS:["Regresar a comunes"],BACK_TO_GROUP:["Regresar al grupo"],BACK_TO_GROUPS:["Volver a grupos"],BACK_TO_MAP:["Regresar al mapa"],BACK_TO_SEARCH:["Regresar a la búsqueda"],BACK_TO_TAG:["Volver a la etiqueta"],ERROR_ADDING_PHOTOS_TO_ALBUM:["Ocurrió un problema al añadir estas fotos al álbum"],ERROR_REMOVING_PHOTOS_FROM_ALBUM:["Ocurrió un problema al quitar estas fotos del álbum"],ERROR_CREATING_ALBUM:["Ocurrió un problema al crear tu álbum nuevo"],STRICTER_PRIVACY_CHANGE_DIALOG_TITLE:["Nivel más estricto de privacidad"],STRICTER_PRIVACY_CHANGE_DIALOG_MESSAGE:["Cuando se aplica un nivel más estricto de privacidad a una foto, se eliminan los favoritos que esta haya acumulado. También cambia la dirección URL de la foto."],TAGS_HELPER_TEXT:["Las etiquetas son palabras clave que facilitan la búsqueda de fotos. Añade tantas como quieras, y los robots amistosos de Flickr intentarán ayudarte agregando algunas por ti."],TAGS_HELP_TEXT:["Las etiquetas son palabras claves que permiten que las fotos sean más fáciles de encontrar en las búsquedas de Flickr. Las que tú añadas aparecerán en gris oscuro. Los robots amistosos de Flickr intentarán ayudar añadiendo algunas por ti, estas aparecerán solo con un contorno gris."],PRIVATE_TAGS_OWNER_HELPER_TEXT:["Esta etiqueta privada solo pueden verla tú, tus amigos y tu familia, que están autorizados a ver esta foto."],PRIVATE_TAGS_FRIENDS_FAMILY_HELPER_TEXT:["Esta etiqueta privada solo puedes verla tú, porque eres amigo o familiar del propietario de la foto."],CREATE_WALLART_WITH_PHOTO:["Crear cuadro con esta foto"],ERROR_ROTATING_PHOTO:["Se produjo un error al intentar girar esta foto. Cierra e inténtalo nuevamente."],ROTATE_PHOTO:["Girar foto"],ERROR_REPLACING_PHOTO:["Se produjo un error al intentar reemplazar esta foto. Cierra e inténtalo nuevamente."],REPLACE_PHOTO:["Reemplazar foto"],PERMANENTLY_REPLACE:['¿Deseas reemplazar de forma permanente esta foto ("',"${photoTitle}",'" por ',"${username}",") por <em>","${fileName}","</em>?"],REPLACE_WARNING:["Si reemplazas una foto, esta acción no puede deshacerse. Elige un archivo para reemplazar esta foto."],REPLACE_UPLOADING:["Subiendo <em>","${fileName}","</em>..."],ERROR_DELETING_PHOTO:["Se produjo un error al intentar eliminar esta foto. Cierra e inténtalo nuevamente."],SHOW_MORE_STATS:["Mostrar más estadísticas"],SIGNUP_AND_DOWNLOAD_TITLE:["¡Encontraste una foto para descargar!"],SIGNUP_AND_DOWNLOAD_VIDEO_TITLE:["¡Encontraste un video para descargar!"],SIGNUP_AND_DOWNLOAD_MESSAGE:["Únete a Flickr y accede a miles de millones de fotos."],SIGNUP_AND_COMMENT_TITLE:["¡Deja un comentario en esta foto!"],SIGNUP_AND_COMMENT_MESSAGE:["Únete a Flickr y podrás dejar un comentario en esta foto."],IMMERSIFY:["Sumérgete"],SIGNUP_FOOTER_MESSAGE:["Únete a Flickr para explorar fotos de clase mundial"],TIMEOUT_FAILURE:["En este momento, estamos teniendo problemas para mostrar esta foto. Vuelve a intentarlo."],BUY:["Comprar"],ADD_A_NOTE:["Agregar una nota"],CONFIRM_NOTE_DELETION:["¿Seguro que deseas eliminar de manera definitiva esta nota?"],VIEWING_PRIVACY:["Privacidad de la vista"],ALLOW_COMMENTING:["Permitir comentarios"],ALLOW_TAGS_NOTES_PEOPLE:["Permitir etiquetas, notas y etiquetas de personas"],SAFETY_LEVEL:["Nivel de seguridad"],SET_SAFETY_LEVEL:["Establecer el nivel de seguridad"],KEYBOARD_SHORTCUTS:["Atajos del teclado"],EDITOR_UPGRADE:["Actualización del editor de fotos"],EDITOR_UPGRADE_MESSAGE:["La función de edición de fotos en la página de fotos de Flickr actualmente está deshabilitada y a la espera de una actualización.<br><br>¡Muy pronto, disfrutarás de un editor de fotos más estable y con más funciones que le sumará valor a tu experiencia de Flickr!<br><br>Lamentamos el inconveniente causado por esta actualización inesperada, pero confiamos en que la espera va a valer la pena."],ERROR_REPLACING_PHOTO_FILE_TYPE:["Se produjo un error al reemplazar una foto.  No se reconoció el tipo de archivo. Prueba con otra foto."],EDITING_DISABLED:["La edición está deshabilitada en este momento"],ENTER_TO_EDIT_TITLE_DESC:["Presiona la tecla Enter para editar el título o la descripción."],BACK_TO_PHOTOSTREAM_EDIT:["Regresar a la página de edición de la galería"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-zoom",function(e,a){var r=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,r,t,m){return""},useData:!0}),t={};e.Array.each([],function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)}),e.Template.register("hermes/zoom",function(a,m){return m=m||{},m.partials=m.partials?e.merge(t,m.partials):t,r(a,m)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-zoom-modal",function(a,l){var e=a.Template.Handlebars.revive({1:function(a,l,e,n,r){var s;return'<img src="'+a.escapeExpression("function"==typeof(s=null!=(s=e.smallSrc||(null!=l?l.smallSrc:l))?s:e.helperMissing)?s.call(null!=l?l:{},{name:"smallSrc",hash:{},data:r}):s)+'" class="zoom-small">'},3:function(a,l,e,n,r){var s;return'<img src="'+a.escapeExpression("function"==typeof(s=null!=(s=e.largeSrc||(null!=l?l.largeSrc:l))?s:e.helperMissing)?s.call(null!=l?l:{},{name:"largeSrc",hash:{},data:r}):s)+'" class="zoom-large">'},compiler:[7,">= 4.0.0"],main:function(a,l,e,n,r){var s,t=null!=l?l:{};return'<div class="zoom-modal hidden">\n\t<div class="zoom-photo-container">\n\t\t'+(null!=(s=e.if.call(t,null!=l?l.smallSrc:l,{name:"if",hash:{},fn:a.program(1,r,0),inverse:a.noop,data:r}))?s:"")+"\n\t\t"+(null!=(s=e.if.call(t,null!=l?l.largeSrc:l,{name:"if",hash:{},fn:a.program(3,r,0),inverse:a.noop,data:r}))?s:"")+'\n\t\t<span class="facade-of-protection-zoom"></span>\n\t</div>\n</div>\n'},useData:!0}),n={};a.Array.each([],function(l){var e=a.Template.get("hermes/"+l);e&&(n[l]=e)}),a.Template.register("hermes/zoom-modal",function(l,r){return r=r||{},r.partials=r.partials?a.merge(n,r.partials):n,e(l,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("animation-manager",function(n){n.AnimationManager=(function(){function i(){t&&(o.forEach(function(n,i){n()}),n.config.win.requestAnimationFrame(i))}function e(e){return o.push(e),t||(t=!0,n.config.win.requestAnimationFrame(i)),{detach:function(){o.splice(o.indexOf(e),1),o.length||(t=!1)}}}var a,t,o;return a||(t=!1,o=[],YUI.Env.isServer||n.config.win.requestAnimationFrame||(function(){var i,e,a=["webkit","moz"],t=0;for(e=0;e<a.length&&!n.config.win.requestAnimationFrame;++e)i=a[e],n.config.win.requestAnimationFrame=n.config.win[i+"RequestAnimationFrame"],n.config.win.cancelAnimationFrame=n.config.win[i+"CancelAnimationFrame"]||n.config.win[i+"CancelRequestAnimationFrame"];n.config.win.requestAnimationFrame&&n.config.win.cancelAnimationFrame||(n.config.win.requestAnimationFrame=function(n){var i=Date.now(),e=Math.max(t+16,i);return setTimeout(function(){n(t=e)},e-i)},n.config.win.cancelAnimationFrame=clearTimeout)})(),a={subscribe:e}),a})()},"@VERSION@",{requires:[]});YUI.add("zoom-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,forceGpu:null,initializer:function(o){return this.photoId=o.photoId,this.disableIfSmall=!!o.disableIfSmall,YUI.Env.isServer||(e.config.win.location.search.indexOf("gpu=on")>-1?this.forceGpu=!0:e.config.win.location.search.indexOf("gpu=off")>-1&&(this.forceGpu=!1)),this},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(o){e.set("photo",o)})},buildContainer:function(){return this.setContainerWithTemplate("zoom"),this},activate:function(){var o=this,t=o.getZoomKeyScope();return this.get("photo").getValue("needsInterstitial")||(this.parentViewContainer=this.get("container").ancestor(".view"),o.registerEventHandler(o.get("container").on("click",function(t){t.preventDefault(),o.cursorCoords=[t.pageX-e.config.win.pageXOffset,t.pageY-e.config.win.pageYOffset],e.rapidTracker.beacon(o.name,"zoomInClick"),o.zoomIn(o.cursorCoords)})),o.registerEventHandler(e.on("photo:zoom",function(t){t.x&&t.y?(o.cursorCoords=[t.x-e.config.win.pageXOffset,t.y-e.config.win.pageYOffset],o.zoomIn(o.cursorCoords)):o.zoomIn(),e.rapidTracker.beacon(o.name,"zoomInRemoteFire")})),o.attachKeyEvent("down:90",e.betterThrottle(function(t){t.preventDefault(),e.rapidTracker.beacon(o.name,"zoomInKeyPress"),o.zoomIn()},100)),o.attachKeyEvent("down:90,27",e.betterThrottle(function(t){t.preventDefault(),e.rapidTracker.beacon(o.name,"zoomOutKeyPress"),o.zoomOut()},100),t),o.attachKeyEvent("down:37,38,39,40",e.betterThrottle(function(t){var n=[o.currentZoomRegion.left,o.currentZoomRegion.top];switch(t.preventDefault(),t.button){case 37:n[0]+=200;break;case 38:n[1]+=200;break;case 39:n[0]-=200;break;case 40:n[1]-=200}e.rapidTracker.beacon(o.name,"zoomPanKeyPress"),o.panZoomNode(n)},16),t),o.registerEventHandler(o.appContext.flapp.before("activeViewChange",function(t){e.fire("flickr:removeKeyEventScope",o.getZoomKeyScope()),o.detachRegisteredEvents(),o.detachEventHandlers(),o.cleanUp()}))),this},getZoomEdgeMargin:function(){return 100},panZoomNodeToCurrentCoords:function(){if(this.zoomedIn){var e=this.cursorCoords,o=this.getZoomPanCoordsForCursor(e);o&&this.panZoomNode(o)}},panZoomNode:function(e){this.currentZoomRegion.left===e[0]&&this.currentZoomRegion.top===e[1]||(e=this.constrainPanCoords(e),this.currentZoomRegion.left=e[0],this.currentZoomRegion.top=e[1],this.pendingCoords=e)},constrainPanCoords:function(e){var o,t,n=this.getZoomEdgeMargin(),i=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],r=[this.zoomImageFullWidth,this.zoomImageFullHeight],a=[r[0]+2*n,r[1]+2*n];return 0,o=i[0]-r[0]-2*n,0,t=i[1]-r[1]-2*n,e[0]>0?e[0]=0:e[0]<o&&(e[0]=o),e[1]>0?e[1]=0:e[1]<t&&(e[1]=t),r[0]<i[0]&&(e[0]=.5*(i[0]-a[0])),r[1]<i[1]&&(e[1]=.5*(i[1]-a[1])),e},getZoomPanCoordsForCursor:function(e){if(e){var o=this.getZoomEdgeMargin(),t=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],n=[this.zoomImageFullWidth,this.zoomImageFullHeight],i=[n[0]+2*o,n[1]+2*o],r=[e[0]/t[0],e[1]/t[1]];return[r[0]*(t[0]-i[0]),r[1]*(t[1]-i[1])]}},getZoomSmallRegion:function(){var o=this.get("container");return{left:o.getX()-e.config.win.pageXOffset-this.getZoomEdgeMargin(),top:o.getY()-e.config.win.pageYOffset-this.getZoomEdgeMargin(),width:parseInt(o.getStyle("width"),10),height:parseInt(o.getStyle("height"),10)}},resizeZoomNode:function(o,t){var n,i,r=this,a=e.config.win.performance&&e.config.win.performance.now;return t?new e.Promise(function(t,s){function h(s){var d=(function(e){var s,h=(a?e-n:Date.now()-n)/r.getZoomTransitionTime();return h>=1?(s=o,r.isAnimatingZoom=!1,setTimeout(function(){t()},r.getZoomTransitionTime())):s={left:i.left+(o.left-i.left)*h,top:i.top+(o.top-i.top)*h,width:i.width+(o.width-i.width)*h,height:i.height+(o.height-i.height)*h},s})(s);(r.zoomingIn||r.zoomingOut)&&(r.resizeZoomNode(d,!1),d!==o&&e.config.win.requestAnimationFrame(h))}r.isAnimatingZoom=!0,n=a?e.config.win.performance.now():Date.now(),i=r.currentZoomRegion,e.config.win.requestAnimationFrame(h)}):(this.currentZoomRegion=o,this.zoomPhotoContainerNode&&this.zoomPhotoContainerNode.setStyle("transform","translate("+o.left+"px, "+o.top+"px) scale("+o.width/this.zoomImageFullWidth+")"),e.Promise.resolve())},getZoomTransitionTime:function(){return 200},zoomOut:function(){var o=this,t=this.zoomNode;e.fire("flickr:removeKeyEventScope",this.getZoomKeyScope()),this.detachEventHandlers(),this.resizeZoomNode(this.getZoomSmallRegion(),!0),t.addClass("hiding"),this.zoomedIn=!1,this.zoomingIn=!1,this.zoomingOut=!0,setTimeout(function(){o.zoomingOut&&t&&t._node&&(o.parentViewContainer.removeClass("zoomed"),t.removeClass("hiding"),t.addClass("hidden"),setTimeout(function(){o.zoomingOut&&(o.cleanUp(),this.zoomingOut=!1)},200))},this.getZoomTransitionTime()+0),delete this.pendingCoords,delete this.currentCoords},detachEventHandlers:function(){this.zoomNode&&(this.zoomNode.detachAll("mousemove"),this.mouseWheelHandler&&this.mouseWheelHandler.detach(),this.touchHandlers&&(this.touchHandlers.forEach(function(e){e.detach()}),delete this.touchHandlers))},cleanUp:function(){this.zoomNode&&(this.zoomNode.remove(!0),this.zoomedIn=!1,this.zoomingIn=!1,this.zoomingOut=!1,delete this.zoomNode,delete this.zoomPhotoContainerNode,delete this.pendingCoords,delete this.currentCoords,this.zoomAnimationHandle.detach())},isImageReadyToDisplay:function(e){var o;return!!e&&(o=new Image,o.src=e,o.complete||o.naturalWidth)},getZoomKeyScope:function(){return this.name+this._yuid},zoomMouseMoveHandler:function(o){this.cursorCoords=[o.pageX-e.config.win.pageXOffset,o.pageY-e.config.win.pageYOffset],this.isAnimatingZoom||this.panZoomNodeToCurrentCoords()},zoomScrollWheelHandler:function(e){e.preventDefault();var o=e.wheelDeltaX,t=e.wheelDeltaY;void 0===o&&(o=-e.deltaX||0),void 0===t&&(t=-e.deltaY||0),this.panZoomNode([this.currentZoomRegion.left+o,this.currentZoomRegion.top+t])},getSizes:function(){var e=this.parentViewContainer.one(".low-res-photo"),o=this.parentViewContainer.one(".main-photo");return{small:e?e.getAttribute("src"):"",medium:o?o.getAttribute("src"):"",large:this.getLargestSize()}},getLargestSize:function(){var e,o=this.appContext.flipper.isFlipped("enable-zoom-proxy"),t=this.appContext.flipper.config["zoom-proxy-prefix"];return o&&t?"o"===(e=this.get("photo").getLargestSize({excludeSizes:[]})).key&&(console.log("proxyPrefix",t,"largestSize.displayUrl",e.displayUrl),e.displayUrl=e.url=t+"http:"+e.displayUrl,console.log("proxying original",e.url)):e=this.get("photo").getLargestSize(),e},zoomIn:function(o){var t,n,i,r,a,s=this,h=this.getSizes(),d=this.isImageReadyToDisplay(h.medium),m=this.isImageReadyToDisplay(h.large.url),c=this.getZoomPixelRatio(),l=this.getZoomSmallRegion(),g=this.maxMsgNode;if(this.disableIfSmall&&l.width>=h.large.width)return g||(g=this.maxMsgNode=e.Node.create('<div class="zoom-max-message">'+s.intlMessage({intlName:"photo-page-scrappy.ZOOM_MAX_MESSAGE"})+"</div>")),this.get("container").contains(g)||(g.addClass("hidden"),this.get("container").append(g)),void setTimeout(function(){g&&g.inDoc()&&(g.removeClass("hidden"),this.maxMsgNodeHidingTimer&&(clearTimeout(this.maxMsgNodeHidingTimer),delete this.maxMsgNodeHidingTimer),this.maxMsgNodeHidingTimer=setTimeout(function(){g&&g.inDoc()&&g.addClass("hidden")},3e3))},0);e.fire("flickr:setKeyEventScope",this.getZoomKeyScope()),this.zoomingIn=!0,this.zoomAnimationHandle=e.AnimationManager.subscribe(function(){var t,n,i=s.getDeteriorationRateForEasing(),r={x:0,y:0},a={x:0,y:0},h={x:0,y:0};s.pendingCoords&&(r.x=parseInt(s.pendingCoords[0],10),r.y=parseInt(s.pendingCoords[1],10),s.currentCoords?(a.x=s.currentCoords[0],a.y=s.currentCoords[1]):(t=s.getZoomPanCoordsForCursor(o),n=s.constrainPanCoords(t),a.x=parseInt(n[0],10),a.y=parseInt(n[1],10)),r.x<a.x?h.x=a.x-Math.abs(r.x-a.x)*i:h.x=a.x+Math.abs(r.x-a.x)*i,r.y<a.y?h.y=a.y-Math.abs(r.y-a.y)*i:h.y=a.y+Math.abs(r.y-a.y)*i,h.x=parseInt(h.x,10),h.y=parseInt(h.y,10),h.x===a.x&&(r.x<a.x?h.x=a.x-1:r.x>a.x&&(h.x=a.x+1)),h.y===a.y&&(r.y<a.y?h.y=a.y-1:r.y>a.y&&(h.y=a.y+1)),h.x===r.x&&h.y===r.y||((!0===s.forceGpu||e.config.win.devicePixelRatio>1)&&!1!==s.forceGpu?s.zoomPhotoContainerNode.setStyle("transform","translate3d("+h.x+"px, "+h.y+"px, 0)"):s.zoomPhotoContainerNode.setStyle("transform","translate("+h.x+"px, "+h.y+"px)")),s.currentCoords=[h.x,h.y],h.x===r.x&&h.y===r.y&&delete s.pendingCoords)}),this.zoomNode?(this.zoomingOut=!1,(t=this.zoomNode).removeClass("hiding"),this.detachEventHandlers()):t=this.zoomNode=e.Node.create(this.templates("zoom-modal")({smallSrc:d?h.medium:h.small,largeSrc:m?h.large.url:""})),n=this.zoomPhotoContainerNode=t.one(".zoom-photo-container"),this.zoomImageFullWidth=h.large.width/c,this.zoomImageFullHeight=h.large.height/c,o||(o=[this.appContext.viewportData.viewport.width/2,this.appContext.viewportData.viewport.height/2],s.cursorCoords=o),i=this.getZoomPanCoordsForCursor(o),i=this.constrainPanCoords(i),r={left:i[0],top:i[1],width:this.zoomImageFullWidth,height:this.zoomImageFullHeight},n.setStyle("transition","none"),this.resizeZoomNode(l,!1),t.on("click",function(o){s.zoomingIn||(o.preventDefault(),e.rapidTracker.beacon(s.name,"zoomOutClick"),s.zoomOut())}),e.one("body").append(t),n.setStyle("width",r.width),n.setStyle("height",r.height),e.soon(function(){s.zoomingIn&&(t.removeClass("hidden"),n.setStyle("transition",""),"ontouchstart"in document&&e.use("event-touch",function(){s.touchHandlers=[],s.touchHandlers.push(e.on("touchstart",function(e){e.changedTouches.length&&1===e.changedTouches.length&&(s.touching=[e.changedTouches[0].pageX,e.changedTouches[0].pageY])})),s.touchHandlers.push(e.on("touchmove",function(e){var o,t,n=e.pageX,i=e.pageY;s.touching&&e.changedTouches.length&&1===e.changedTouches.length&&(n=e.changedTouches[0].pageX,i=e.changedTouches[0].pageY,e.preventDefault(),o=n-s.touching[0],t=i-s.touching[1],s.touching=[n,i],s.panZoomNode([s.currentZoomRegion.left+o,s.currentZoomRegion.top+t]))})),s.touchHandlers.push(e.on("touchend",function(e){delete s.touching}))}),"ontouchstart"in document&&!s.appContext.flipper.isFlipped("enable-always-bind-mouse-events-zoom-view")||(t.on("mousemove",s.zoomMouseMoveHandler.bind(s)),s.mouseWheelHandler=(function(){var e=s.zoomScrollWheelHandler.bind(s);return a="onwheel"in document.createElement("div")?"wheel":"mousewheel",document.addEventListener(a,e,!1),{detach:function(){document.removeEventListener(a,e,!1)}}})()),s.parentViewContainer.addClass("zoomed"),s.resizeZoomNode(r,!0).then(function(){s.zoomingIn&&(s.zoomingIn=!1,s.zoomedIn=!0,s.panZoomNodeToCurrentCoords(),m||n.append('<img src="'+h.large.url+'" class="zoom-large">'))}))})},getDeteriorationRateForEasing:function(){return.2},getZoomPixelRatio:function(){return 1}})},"@VERSION@",{requires:["flickr-view","better-throttle","flickr-promise","hermes-template-zoom","hermes-template-zoom-modal","animation-manager"],optional:["photo-models"],langBundles:["photo-page-scrappy"]});YUI.add("hermes-template-photo-well-media-scrappy",function(t,a){var e=t.Template.Handlebars.revive({1:function(t,a,e,l,n){var i,s=null!=a?a:{};return'\t<div class="restricted-interstitial">\n\t\t<div class="restricted-interstitial-message">\n\t\t\t<h2>'+t.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:n}))+"</h2>\n"+(null!=(i=e.if.call(s,null!=a?a.isSignedIn:a,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.program(5,n,0),data:n}))?i:"")+"\t\t</div>\n\t</div>\n"},2:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return"\t\t\t\t<p>"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:n}))+"<br />"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:n}))+"</p>\n\n"+(null!=(i=e.unless.call(s,null!=a?a.isMinor:a,{name:"unless",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?i:"")},3:function(t,a,e,l,n){var i=null!=a?a:{},s=e.helperMissing,h=t.escapeExpression;return"\t\t\t\t\t<p><button class='ui-button'><span>"+h((e.intlMessage||a&&a.intlMessage||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:n}))+"</span></button></p>\n\t\t\t\t\t<p>"+h((e.intlHTMLMessage||a&&a.intlHTMLMessage||s).call(i,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:n}))+"</p>\n"},5:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return"\t\t\t\t<p>"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:n}))+' <a href="//'+r("function"==typeof(i=null!=(i=e.host||(null!=a?a.host:a))?i:h)?i.call(s,{name:"host",hash:{},data:n}):i)+'/signin/" data-track="photoWellSignInClick">'+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:n}))+"</a></p>\n"},7:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.isVideo:a,{name:"if",hash:{},fn:t.program(8,n,0),inverse:t.program(11,n,0),data:n}))?i:""},8:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.isPending:a,{name:"if",hash:{},fn:t.noop,inverse:t.program(9,n,0),data:n}))?i:""},9:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return'\t\t<div class="videoplayer main-photo" style="width:'+r("function"==typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)?i.call(s,{name:"width",hash:{},data:n}):i)+"px; height:"+r("function"==typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)?i.call(s,{name:"height",hash:{},data:n}):i)+'px;"><video id="video_1" poster="'+r("function"==typeof(i=null!=(i=e.src||(null!=a?a.src:a))?i:h)?i.call(s,{name:"src",hash:{},data:n}):i)+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},11:function(t,a,e,l,n){var i;return"\n"+(null!=(i=e.if.call(null!=a?a:{},null!=a?a.showFuzzy:a,{name:"if",hash:{},fn:t.program(12,n,0),inverse:t.program(14,n,0),data:n}))?i:"")},12:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return'\t\t<span class="restricted-image main-photo" style="width:'+r("function"==typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)?i.call(s,{name:"width",hash:{},data:n}):i)+"px;height:"+r("function"==typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)?i.call(s,{name:"height",hash:{},data:n}):i)+'px;">\n\t\t</span>\n'},14:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r="function",o=t.escapeExpression;return'\t\t<span class="facade-of-protection-neue" style="width:'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+"px;height:"+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'px;">\n\t\t\t'+o((e.outlet||a&&a.outlet||h).call(s,null!=a?a["zoom-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\t\t\t"+o((e.outlet||a&&a.outlet||h).call(s,null!=a?a["vr-overlay-view"]:a,{name:"outlet",hash:{},data:n}))+'\n\t\t</span>\n\n\t\t<img width="'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.src||(null!=a?a.src:a))?i:h)===r?i.call(s,{name:"src",hash:{},data:n}):i)+'" class="low-res-photo" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t<img width="'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.highResSrc||(null!=a?a.highResSrc:a))?i:h)===r?i.call(s,{name:"highResSrc",hash:{},data:n}):i)+'" class="main-photo is-hidden" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t<script nonce="'+o(typeof(i=null!=(i=e.cspNonce||(null!=a?a.cspNonce:a))?i:h)===r?i.call(s,{name:"cspNonce",hash:{},data:n}):i)+"\">\n\t\tvar img = document.querySelector('.photo-well-media-scrappy-view img.main-photo');\n\t\timg.onload = function () { registerFirstPhoto(img); };\n\t\t<\/script>\n\t\t<noscript>\n\t\t\t<img width=\""+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.highResSrc||(null!=a?a.highResSrc:a))?i:h)===r?i.call(s,{name:"highResSrc",hash:{},data:n}):i)+'" class="main-photo" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t</noscript>\n'},compiler:[7,">= 4.0.0"],main:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.needsInterstitial:a,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(7,n,0),data:n}))?i:""},useData:!0}),l={};t.Array.each([],function(a){var e=t.Template.get("hermes/"+a);e&&(l[a]=e)}),t.Template.register("hermes/photo-well-media-scrappy",function(a,n){return n=n||{},n.partials=n.partials?t.merge(l,n.partials):l,e(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-well-media-scrappy-view",function(e,t){var i,n=require("hermes-core/flog")(t);i={photo:{render:function(){var t,i,n,o=this,r=this.get("photo"),s="";return o.preloadImage&&(o.preloadImage.onload=null),this.appContext.forceServerRender?i=t=this.getPhotoForDisplay({canvas:{width:Number.MAX_VALUE,height:Number.MAX_VALUE}}):(t=this.getPhotoForDisplay(),i=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]})),r.getValue("owner")&&(s=""===r.getValue("title").trim()?this.intlMessage({intlName:"common.UNTITLED"}):r.getValue("title"),s+=" | "+this.intlMessage({intlName:"common.BY_USER",user:r.getValue("owner").getValue("username")})),(n=this.get("container").one(".main-photo"))&&parseInt(n.getAttribute("width"),10)===t.width&&parseInt(n.getAttribute("height"),10)===t.height||this.setContainerWithTemplate("photo-well-media-scrappy",{width:t.width,height:t.height,src:i.url,highResSrc:t.url,imgAltText:s,needsInterstitial:r.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1,isMinor:this.appContext.getViewer().isMinor}),YUI.Env.isServer?(this.serverWidth=t.width,this.serverHeight=t.height):r.getValue("needsInterstitial")||(o.preloadImage=new Image,o.preloadImage.onload=function(){if(!this.onloadFired&&o.isActiveAndInDOM()){this.onloadFired=!0;var i,n="photoPageShowedSize",r="ø";try{(i=/(?:_([a-z]))?\.jpg/.exec(t.url))&&i[1]&&(r=i[1])}catch(e){}finally{n+=String(r).toUpperCase()}e.rapidTracker.beacon(this.name,n);var s=o.get("container").one(".low-res-photo");o.get("container").one(".main-photo").removeClass("is-hidden").show(),s.hide()}},o.preloadImage.src=t.url,o.preloadImage.complete&&o.preloadImage.onload()),this}},video:{render:function(){var e=this.get("photo"),t=this.getPhotoForDisplay({excludeSizes:[]});return!this.player||e.getValue("isVideoPending")?(this.setContainerWithTemplate("photo-well-media-scrappy",{width:t.width,height:t.height,src:t.url,needsInterstitial:e.getValue("needsInterstitial"),isVideo:!0,isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":"",isPending:e.getValue("isVideoPending")}),this):(e.getValue("isVideoPending")||(this.player.dimension?(this.player.dimension("width",t.width),this.player.dimension("height",t.height)):this.player.resize(t.width,t.height)),this)}},ad:{render:function(){return this}}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"vr-overlay-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,destinationContainer:".photo-well-media-scrappy-view",disabled:function(){return!this.appContext.flipper.isFlipped("enable-vr")}}},initializer:function(e){return this.photoId=e.photoId,this.isAd=!!e.ad,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var t=this;return this.appContext.getModel("photo-models",t.photoId).then(function(i){if(t.set("photo",i),i.getValue("isVideo"))return new e.Promise(function(t,i){e.use("flickr-video-player",function(){t()})})})},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?i.ad.render.call(this):i[this.get("photo").getValue("isVideo")?"video":"photo"].render.call(this),!YUI.Env.isServer&&this.subviews["vr-overlay-view"]&&this.subviews["vr-overlay-view"].get("canVr")&&this.subviews["zoom-view"]&&(this.canVR=!0,this.subviews["zoom-view"].destroy({remove:!0})),this.get("photo").getValue("needsInterstitial")?this.get("container").addClass("has-interstitial"):this.get("container").removeClass("has-interstitial"),this},handleInterstitialDismissButtonClick:function(t){var i=this,o=this.get("personPreferences"),r=this.get("photo"),s=r.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),o.setValue("safeSearch",s),o.registry.remoteUpdate(i.appContext.auth.user.nsid).then(function(e){r.registry.attributeSearch({needsInterstitial:!0}).forEach(function(e){r.registry.getValue(e,"safetyLevel")<=o.getValue("safeSearch")&&r.registry.setValue(e,"needsInterstitial",!1)}),i.buildContainer(),i.fire("subviewViewEvent","photoWellResized")},function(e){n.error({err:e}),i.onError(i.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))})},onParentViewEvent:function(e,t){t&&"photoWellResized"===t[0]&&(this.get("photo").getValue("needsInterstitial")||(this.set("canvasSizeIsDirty",!0),this.buildContainer()))},activate:function(){var t=this;return this.get("photo").getValue("isVideo")&&!this.get("photo").getValue("isVideoPending")&&(t.player=new e.FlickrVideoPlayer({container:t.get("container").one(".videoplayer"),model:t.get("photo"),appContext:t.appContext,videoNode:e.one("#video_1")?e.one("#video_1")._node:null,controlBar:{fullscreenToggle:!1}}),t.player.init().then(function(){}),t.on("destroy",function(){t.player&&(t.player.destroy(),t.player=null)})),this.get("photo").getValue("needsInterstitial")||this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()})),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&t.get("container").one(".restricted-interstitial-message button")&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))}),this},onError:function(t){new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:this.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,classList:"scrappy-dialog"}).show()},getPhotoForDisplay:function(e){var t,i,n,o=this.getCanvasSize(),r=this.getPixelRatio();return e&&e.canvasSize&&(o=e.canvasSize),t=this.get("photo").getSizeToFit(o,e),i=Math.min(o.height/r,t.height),n=Math.min(o.width/r,t.width/t.height*i),i=Math.min(i,t.height/t.width*n),{width:Math.round(n),height:Math.round(i),url:t.url,pixelRatio:t.width/n}},getCanvasSize:function(){var e,t,i,n,o,r,s=this.getPixelRatio(),a=this.get("container"),h={width:500,height:500};return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(t=this.get("container").ancestor(),i=a.getStyle("paddingTop")?parseInt(a.getStyle("paddingTop").match(/[0-9]+/)[0],10):0,n=a.getStyle("paddingBottom")?parseInt(a.getStyle("paddingBottom").match(/[0-9]+/)[0],10):0,r=40,o=40,t&&((e=t.get("region")).height=parseInt(t.getStyle("height").match(/[0-9]+/)[0],10)-(i+n),e.width=this.appContext.viewportData.viewport.width-(r+o))):e=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(h={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),e||(e={top:0,left:0,bottom:500,right:500,width:h.width,height:h.height}),e.height*=s,e.width*=s,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})},"@VERSION@",{requires:["flickr-view","moment","vr-overlay-view","zoom-view","hermes-template-photo-well-media-scrappy"],optional:["photo-models"],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-template-context-slider-photo",function(a,e){var l=a.Template.Handlebars.revive({1:function(a,e,l,t,n){return"currentImage"},3:function(a,e,l,t,n){return"restricted-image"},5:function(a,e,l,t,n){return"\t\t<span class='play-slideshow'>&#9654;</span>\n\t\t<span class='countdown-slideshow'></span>\n"},compiler:[7,">= 4.0.0"],main:function(a,e,l,t,n){var r,s,i=null!=e?e:{},o=l.helperMissing,u="function",c=a.escapeExpression;return'<a class="context-thumb emptyImage '+(null!=(r=l.if.call(i,null!=e?e.currentPhoto:e,{name:"if",hash:{},fn:a.program(1,n,0),inverse:a.noop,data:n}))?r:"")+" "+(null!=(r=l.if.call(i,null!=e?e.needsInterstitial:e,{name:"if",hash:{},fn:a.program(3,n,0),inverse:a.noop,data:n}))?r:"")+'" href="'+c(typeof(s=null!=(s=l.url||(null!=e?e.url:e))?s:o)===u?s.call(i,{name:"url",hash:{},data:n}):s)+'" data-track="contextSliderNextPhotoClick" style="background-image: url('+c(typeof(s=null!=(s=l.background||(null!=e?e.background:e))?s:o)===u?s.call(i,{name:"background",hash:{},data:n}):s)+"); left: "+c(typeof(s=null!=(s=l.left||(null!=e?e.left:e))?s:o)===u?s.call(i,{name:"left",hash:{},data:n}):s)+'px" data-photo-id="'+c(typeof(s=null!=(s=l.id||(null!=e?e.id:e))?s:o)===u?s.call(i,{name:"id",hash:{},data:n}):s)+'" title="'+c(typeof(s=null!=(s=l.title||(null!=e?e.title:e))?s:o)===u?s.call(i,{name:"title",hash:{},data:n}):s)+'" tabindex="-1">\n'+(null!=(r=l.if.call(i,null!=e?e.currentPhoto:e,{name:"if",hash:{},fn:a.program(5,n,0),inverse:a.noop,data:n}))?r:"")+"</a>\n"},useData:!0}),t={};a.Array.each([],function(e){var l=a.Template.get("hermes/"+e);l&&(t[e]=l)}),a.Template.register("hermes/context-slider-photo",function(e,n){return n=n||{},n.partials=n.partials?a.merge(t,n.partials):t,l(e,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-context-slider-scrappy",function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,a,r){var l=null!=n?n:{},s=e.helperMissing,o=t.escapeExpression;return"\t<div class='loadingError'>\n\t\t<p>"+o((e.intlMessage||n&&n.intlMessage||s).call(l,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ERROR_LOADING_CONTEXT"},data:r}))+'</p>\n\t\t<p><button href="#" class="ui-button ui-button-cta ui-button-transparent retry">'+o((e.intlMessage||n&&n.intlMessage||s).call(l,{name:"intlMessage",hash:{intlName:"common.RETRY"},data:r}))+"</button></p>\n\t</div>\n"},3:function(t,n,e,a,r){var l,s=null!=n?n:{};return"\n\t<div class='context-slider small-slider "+(null!=(l=e.if.call(s,null!=n?n.slideshowEnabled:n,{name:"if",hash:{},fn:t.program(4,r,0),inverse:t.noop,data:r}))?l:"")+'\'>\n\n\t\t<div class="wrapper is-ready clear-float small-photos">\n\n\t\t\t<div class="slider">\n\n'+(null!=(l=e.each.call(s,null!=n?n.previousPhotos:n,{name:"each",hash:{},fn:t.program(6,r,0),inverse:t.noop,data:r}))?l:"")+"\n"+(null!=(l=e.if.call(s,null!=n?n["is-ad"]:n,{name:"if",hash:{},fn:t.program(8,r,0),inverse:t.program(10,r,0),data:r}))?l:"")+"\n\n"+(null!=(l=e.each.call(s,null!=n?n.nextPhotos:n,{name:"each",hash:{},fn:t.program(6,r,0),inverse:t.noop,data:r}))?l:"")+"\n\t\t\t</div>\n\n\t\t</div>\n\n\t</div>\n\n"+(null!=(l=e.if.call(s,null!=n?n.showBigSlider:n,{name:"if",hash:{},fn:t.program(13,r,0),inverse:t.noop,data:r}))?l:"")+"\n"},4:function(t,n,e,a,r){return"slideshowEnabled"},6:function(t,n,e,a,r){var l;return null!=(l=t.invokePartial(a["context-slider-photo"],n,{name:"context-slider-photo",data:r,indent:"\t\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?l:""},8:function(t,n,e,a,r){return'\t\t\t\t\t<a class="context-thumb middle currentImage adThumb">Ad</a>\n'},10:function(t,n,e,a,r){var l;return null!=(l=e.each.call(null!=n?n:{},null!=n?n.currentPhoto:n,{name:"each",hash:{},fn:t.program(11,r,0),inverse:t.noop,data:r}))?l:""},11:function(t,n,e,a,r){var l;return null!=(l=t.invokePartial(a["context-slider-photo"],n,{name:"context-slider-photo",data:r,indent:"\t\t\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?l:""},13:function(t,n,e,a,r){var l,s=null!=n?n:{},o=e.helperMissing,i=t.escapeExpression;return"\t\t<div class='context-slider big-slider "+(null!=(l=e.if.call(s,null!=n?n.slideshowEnabled:n,{name:"if",hash:{},fn:t.program(4,r,0),inverse:t.noop,data:r}))?l:"")+'\'>\n\n\t\t\t<span class="nav nav-l">\n\t\t\t\t<span class="hide-text">&larr;</span>\n\t\t\t</span>\n\n\t\t\t<div class="wrapper clear-float">\n\n\t\t\t\t<div class="slider">\n\n\t\t\t\t\t'+i((e.renderTrustedMarkup||n&&n.renderTrustedMarkup||o).call(s,null!=n?n.previousBigPhotos:n,{name:"renderTrustedMarkup",hash:{},data:r}))+"\n\n"+(null!=(l=e.if.call(s,null!=n?n["is-ad"]:n,{name:"if",hash:{},fn:t.program(14,r,0),inverse:t.program(16,r,0),data:r}))?l:"")+"\n\t\t\t\t\t"+i((e.renderTrustedMarkup||n&&n.renderTrustedMarkup||o).call(s,null!=n?n.nextBigPhotos:n,{name:"renderTrustedMarkup",hash:{},data:r}))+'\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<span class="nav nav-r">\n\t\t\t\t<span class="hide-text">&rarr;</span>\n\t\t\t</span>\n\n\t\t</div>\n'},14:function(t,n,e,a,r){return'\t\t\t\t\t\t<a class="context-thumb middle currentImage adThumb">Ad</a>\n'},16:function(t,n,e,a,r){var l;return null!=(l=e.each.call(null!=n?n:{},null!=n?n.currentPhoto:n,{name:"each",hash:{},fn:t.program(17,r,0),inverse:t.noop,data:r}))?l:""},17:function(t,n,e,a,r){var l;return null!=(l=t.invokePartial(a["context-slider-photo"],n,{name:"context-slider-photo",data:r,indent:"\t\t\t\t\t\t\t",helpers:e,partials:a,decorators:t.decorators}))?l:""},compiler:[7,">= 4.0.0"],main:function(t,n,e,a,r){var l;return null!=(l=e.if.call(null!=n?n:{},null!=n?n.loadingError:n,{name:"if",hash:{},fn:t.program(1,r,0),inverse:t.program(3,r,0),data:r}))?l:""},usePartial:!0,useData:!0}),a={};t.Array.each(["context-slider-photo","context-slider-photo","context-slider-photo","context-slider-photo"],function(n){var e=t.Template.get("hermes/"+n);e&&(a[n]=e)}),t.Template.register("hermes/context-slider-scrappy",function(n,r){return r=r||{},r.partials=r.partials?t.merge(a,r.partials):a,e(n,r)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-context-slider-photo","hermes-template-context-slider-photo","hermes-template-context-slider-photo","hermes-template-context-slider-photo"]});YUI.add("hermes-template-context-image",function(e,a){var t=e.Template.Handlebars.revive({1:function(e,a,t,l,n){var r;return'\n\t<a data-loaded="false" style="left:'+e.escapeExpression("function"==typeof(r=null!=(r=t.left||(null!=a?a.left:a))?r:t.helperMissing)?r.call(null!=a?a:{},{name:"left",hash:{},data:n}):r)+';float:left;display:block;position:absolute;background-color:gray;height:40px;width:86px;border:1px solid transparent;" href="#">\n\t\t\n\t</a>\n\n'},compiler:[7,">= 4.0.0"],main:function(e,a,t,l,n){var r;return null!=(r=t.each.call(null!=a?a:{},null!=a?a.images:a,{name:"each",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n}))?r:""},useData:!0}),l={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(l[a]=t)}),e.Template.register("hermes/context-image",function(a,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,t(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-context-text",function(e,t){var a=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,a,l,n){var r,s=null!=t?t:{},i=a.helperMissing,p=e.escapeExpression;return'\n\n<span data-loaded="true" style="left:'+p("function"==typeof(r=null!=(r=a.left||(null!=t?t.left:t))?r:i)?r.call(s,{name:"left",hash:{},data:n}):r)+';float:left;display:block;position:absolute;height:40px;width:86px;border:1px solid #ccc;" href="#">\n\t'+p("function"==typeof(r=null!=(r=a.text||(null!=t?t.text:t))?r:i)?r.call(s,{name:"text",hash:{},data:n}):r)+"\n</span>\n\n"},useData:!0}),l={};e.Array.each([],function(t){var a=e.Template.get("hermes/"+t);a&&(l[t]=a)}),e.Template.register("hermes/context-text",function(t,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,a(t,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("context-slider-scrappy-view",function(t,e){var o=require("hermes-core/flog")(e);t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.contextData=t.clone(e.context,!0),this.currentPosition=0,this.numberOfPhotosEitherSideInViewPort=3,this.numberOfPositionsToMove=3,this.numberOfPositionsToBuffer=3,this.positionsLoadedNext=0,this.positionsLoadedPrev=0,this.positionsAheadLimit=25,this.numberOfPositionsToPreFetch=e.numberOfPositionsToPreFetch,this.numberOfPositionsToRefetchAt=e.numberOfPositionsToRefetchAt,this.photoWidth=50,this.photoMargin=15,this.photoWidthPlusMargin=65,this.photoWidthSmall=20,this.photoMarginSmall=5,this.photoWidthPlusMarginSmall=25,this.atStart=!1,this.atEnd=!1,this.isAd=!!e.ad,this.photosInSlider={},YUI.Env.isServer||"true"!==t.StorageHelper.getItem("slideshowInProgress")?this.slideshowInProgress=!1:this.slideshowInProgress=!0,this.slideshowDwellSeconds=5,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var e=this,i=e.contextData;return new t.FlickrPromise({photo:e.appContext.getModel("photo-models",e.photoId),context:e.appContext.getModel(i.modelName,i.params)}).then(function(t){e.set("photo",t.photo),e.set("contextModel",t.context)},function(t){if(!t.getModelFailure&&1!==t.code||"photostream-models"===i.modelName)throw t;return e.contextData.modelName="photostream-models",e.appContext.getModel("photo-models",e.photoId).then(function(t){return e.set("photo",t),e.contextData.params.id=e.get("photo").getValue("owner").getValue("nsid"),e.appContext.getModel("photostream-models",e.contextData.params).then(function(t){e.set("contextModel",t)})})}).then(function(){var o=t.merge(i.params,{photoId:e.photoId,numNext:e.numberOfPositionsToPreFetch,numPrev:e.numberOfPositionsToPreFetch,refetchAt:e.numberOfPositionsToRefetchAt});return e.get("contextModel").getValue("photoContextList").getContext(o)}).then(function(t){e.positionsLoadedNext=e.positionsLoadedNext+t.next.length,e.positionsLoadedPrev=e.positionsLoadedPrev+t.previous.length,e.photosInSlider[0]=e.get("photo").getValue("id"),e.set("initialContextResponse",t)},function(t){if(t.notInContext||99===t.code)return e.get("contextModel").setValue("photoContextList",[]),e.contextData.modelName="photostream-models",e.contextData.params.id=e.get("photo").getValue("owner").getValue("nsid"),e.loadState();throw t}).then(null,function(t){throw o.error("There was a problem loading the context slider data.",{err:t}),t})},assignContextPositionsAndAddToDOM:function(t){var e,o,i,s=this.get("container"),n=s.one(".small-slider .slider"),r=s.one(".big-slider .slider"),h=t.contextResponse;for(i=0;i<h.previous.length;i++)o=-1-i,void 0===this.photosInSlider[o]&&(e=h.previous[i].toJSON(),this.photosInSlider[o]=h.previous[i].getValue("id"),e.left=o*this.photoWidthPlusMarginSmall,e.background=this.getBackgroundImage(h.previous[i]),e.url=this.getContextifiedURLForPhoto(h.previous[i]),n.append(this.templates("context-slider-photo")(e)),e.left=o*this.photoWidthPlusMargin,r.append(this.templates("context-slider-photo")(e)));for(i=0;i<h.next.length;i++)o=1+i,void 0===this.photosInSlider[o]&&(e=h.next[i].toJSON(),this.photosInSlider[o]=h.next[i].getValue("id"),e.left=o*this.photoWidthPlusMarginSmall,e.background=this.getBackgroundImage(h.next[i]),e.url=this.getContextifiedURLForPhoto(h.next[i]),n.append(this.templates("context-slider-photo")(e)),e.left=o*this.photoWidthPlusMargin,r.append(this.templates("context-slider-photo")(e)))},checkBoundary:function(t){var e=t.contextResponse,o=t.requestedPreviousAmount,i=t.requestedNextAmount,s=t.positionWhenChecking,n=this.get("contextModel").getValue("photoContextList"),r=this.get("container"),h=r.one(".nav-l"),a=r.one(".nav-r");this.currentPosition-this.numberOfPhotosEitherSideInViewPort>this.positionsLoadedNext&&this.move(-Math.abs(this.currentPosition-this.positionsLoadedNext)),this.currentPosition<0&&Math.abs(this.currentPosition+this.numberOfPhotosEitherSideInViewPort)>this.positionsLoadedPrev&&this.move(Math.abs(this.currentPosition+this.numberOfPhotosEitherSideInViewPort)-this.positionsLoadedPrev),n.hasMinBoundary()&&e.previous.length-Math.abs(s)<=this.numberOfPhotosEitherSideInViewPort&&o>0&&(h.hide(),this.atStart=!0),n.hasMaxBoundary()&&e.next.length-Math.abs(s)<=this.numberOfPhotosEitherSideInViewPort&&i>0&&(a.hide(),this.atEnd=!0)},buildContainer:function(){function t(t,e,s,n){t>3&&(t=3);for(var r=o[e],h="",a=0;a<t;a++){var l=r[a],d=l.toJSON(),u=(a+1)*i.photoWidthPlusMarginSmall*n;d.background=i.getBackgroundImage(l),d.currentPhoto=!1,d.url=i.getContextifiedURLForPhoto(l),d.left=u/i.photoWidthPlusMarginSmall*i.photoWidthPlusMargin,h+=i.templates("context-slider-photo")(d),d.left=u,s.push(d),i.photosInSlider[""+(a+1)*n]=d}return h}var e=this.get("photo").toJSON(),o=this.get("initialContextResponse"),i=this;e.background=this.getBackgroundImage(this.get("photo")),e.left=0,e.currentPhoto=!0,e.url=this.getContextifiedURLForPhoto(this.get("photo"));var s=[],n=[],r="",h="";this.positionsLoadedNext>0&&(h=t(this.positionsLoadedNext,"next",s,1)),this.positionsLoadedPrev>0&&(r=t(this.positionsLoadedPrev,"previous",n,-1)),this.setContainerWithTemplate("context-slider-scrappy",{previousPhotos:n,nextPhotos:s,previousBigPhotos:r,nextBigPhotos:h,currentPhoto:[e],slideshowEnabled:this.appContext.flipper.isFlipped("enable-photopage-slideshow"),"is-ad":this.isAd,showBigSlider:!this.appContext.forceServerRender}),this.isAd&&(o.next.pop(),o.next=[this.get("photo")].concat(o.next))},buildErrorContainer:function(){this.setContainerWithTemplate("context-slider-scrappy",{loadingError:!0})},activate:function(){var e,o,i=this,s=i.get("container"),n=s.one(".big-slider"),r=!1,h=this.appContext.getViewer().prefs.keyboardShortcutsEnabled,a=this.numberOfPhotosEitherSideInViewPort;return this.assignContextPositionsAndAddToDOM({contextResponse:this.get("initialContextResponse"),requestedPreviousAmount:a,requestedNextAmount:a}),this.checkBoundary({contextResponse:this.get("initialContextResponse"),requestedPreviousAmount:a,requestedNextAmount:a,positionWhenChecking:this.currentPosition}),"true"===t.StorageHelper.getItem("showBigContextSlider")?(s.addClass("hover"),setTimeout(function(){s.setStyle("transition","opacity 300ms ease-out, background-position 150ms ease-out"),s.all(".context-slider").setStyle("transition","opacity 300ms ease-out")},300)):(s.setStyle("transition","opacity 300ms ease-out, background-position 150ms ease-out"),s.all(".context-slider").setStyle("transition","opacity 300ms ease-out")),this.appContext.flipper.isFlipped("enable-photopage-slideshow")&&(this.slideshowInProgress&&this.startSlideshow(),this.get("container").all(".currentImage")&&this.registerEventHandler(this.get("container").all(".currentImage").on("click",function(t){t.preventDefault(),i.slideshowInProgress?i.stopSlideshow():i.startSlideshow()}))),t.use("transition",function(t){var a=i.get("container").one(".nav-l"),l=i.get("container").one(".nav-r");a&&i.registerEventHandler(a.on("click",function(){s.setStyle("transition","opacity 300ms ease-out"),t.rapidTracker.beacon(i.name,"contextSliderMoveLeftClick"),i.move(-1*i.numberOfPositionsToMove)})),l&&i.registerEventHandler(l.on("click",function(){s.setStyle("transition","opacity 300ms ease-out"),t.rapidTracker.beacon(i.name,"contextSliderMoveRightClick"),i.move(1*i.numberOfPositionsToMove)})),h&&(i.attachKeyEvent("down:188",t.betterThrottle(function(e){t.rapidTracker.beacon(i.name,"contextSliderMoveLeftKeyPress"),s.addClass("hover"),i.bringIntoFocus(),i.atStart||i.move(-1*i.numberOfPositionsToMove)},20)),i.attachKeyEvent("down:190",t.betterThrottle(function(e){t.rapidTracker.beacon(i.name,"contextSliderMoveRightKeyPress"),s.addClass("hover"),i.bringIntoFocus(),i.atEnd||i.move(1*i.numberOfPositionsToMove)},20))),i.registerEventHandler(s.on("hover",function(){r=!0,clearTimeout(e),e=setTimeout(function(){r&&s.addClass("hover")},150)},function(){r=!1,clearTimeout(o),t.StorageHelper.setItem("showBigContextSlider","false"),o=setTimeout(function(){r||(s.setStyles({width:"100%",height:"80px"}),n.setStyle("height","80px"),s.removeClass("hover"),setTimeout(function(){s.removeAttribute("style"),n.removeAttribute("style")},300))},500)})),s.all(".context-thumb:not(.currentImage)")&&i.registerEventHandler(s.all(".context-thumb:not(.currentImage)").on("click",function(){t.StorageHelper.setItem("showBigContextSlider","true")}))}),this},startSlideshow:function(){function e(){0===s&&o.slideshowInProgress?o.appContext.flapp.navigate(i):(n.all(".currentImage .countdown-slideshow").set("text",s),s-=1)}this.slideshowInProgress=!0;var o=this,i=this.getContextifiedURLForPhoto(this.get("initialContextResponse").next[0]),s=this.slideshowDwellSeconds,n=this.get("container");t.StorageHelper.setItem("slideshowInProgress","true"),n.all(".currentImage .play-slideshow").hide(),e(),this.slideshowTimer=setInterval(function(){e()},1e3)},stopSlideshow:function(){this.slideshowInProgress=!1,this.get("container").all(".currentImage .countdown-slideshow").set("text",""),this.get("container").all(".currentImage .play-slideshow").show(),clearInterval(this.slideshowTimer),t.StorageHelper.setItem("slideshowInProgress","false")},move:function(e){var o,i,s,n,r,h=this,a=this.get("contextModel").getValue("photoContextList"),l=e>0?"right":"left",d=this.get("container"),u=d.one(".big-slider .slider"),p=d.one(".small-slider .slider"),c=d.one(".nav-l"),g=d.one(".nav-r");return!("right"===l&&this.currentPosition-this.positionsLoadedNext>this.positionsAheadLimit)&&(!("left"===l&&this.currentPosition<=0&&Math.abs(this.currentPosition)-this.positionsLoadedPrev>this.positionsAheadLimit)&&(d.addClass("hover"),this.currentPosition+=e,r=this.currentPosition,void 0!==this.photosInSlider[this.currentPosition+this.numberOfPhotosEitherSideInViewPort+1]&&(g.show(),this.atEnd=!1),void 0!==this.photosInSlider[this.currentPosition-(this.numberOfPhotosEitherSideInViewPort+1)]&&(c.show(),this.atStart=!1),o=this.currentPosition*this.photoWidthPlusMargin*-1,i=this.currentPosition*this.photoWidthPlusMarginSmall*-1,u.transition({left:o+"px",duration:.3,easing:"ease-out"}),p.setStyle("left",i+"px"),"right"===l?s=this.currentPosition+this.numberOfPositionsToMove+this.numberOfPositionsToBuffer:"left"===l&&(s=this.currentPosition-(this.numberOfPositionsToMove+this.numberOfPositionsToBuffer)),void(void 0===this.photosInSlider[s]&&(n=t.merge(h.contextData.params,{photoId:this.get("photo").getValue("id"),refetchAt:this.numberOfPositionsToRefetchAt}),"right"===l?n.numNext=Math.abs(s)+this.numberOfPositionsToPreFetch:"left"===l&&(n.numPrev=Math.abs(s)+this.numberOfPositionsToPreFetch),a.getContext(n).then(function(t){h.positionsLoadedNext=void 0!==n.numNext?n.numNext:h.positionsLoadedNext,h.positionsLoadedPrev=void 0!==n.numPrev?n.numPrev:h.positionsLoadedPrev,h.assignContextPositionsAndAddToDOM({contextResponse:t,requestedPreviousAmount:n.numPrev,requestedNextAmount:n.numNext}),h.checkBoundary({contextResponse:t,requestedPreviousAmount:n.numPrev,requestedNextAmount:n.numNext,positionWhenChecking:r})},function(t){h.checkBoundary({contextResponse:{previous:[],next:[]},requestedPreviousAmount:n.numPrev,requestedNextAmount:n.numNext,positionWhenChecking:r})})))))},getBackgroundImage:function(t){var e,o,i=this.appContext.getViewer().getPixelRatio();return e={width:this.photoWidth*i,height:this.photoWidth*i},o={cropToFit:!0,includeSizes:["sq","t","q","s","n"]},t.getSizeToFit(e,o).url},getContextifiedURLForPhoto:function(e){if(e){return t.URLHelper.getPhotoPage({photoId:e.getValue("id"),pathAlias:e.getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextModel").getValue("urlSuffix")})}},beforeDestroy:function(){clearInterval(this.slideshowTimer)}})},"@VERSION@",{requires:["flickr-view","hermes-template-context-slider-scrappy","hermes-template-context-slider-photo","hermes-template-context-image","hermes-template-context-text","storage-helper"],optional:[],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-template-photo-engagement",function(e,n){var a=e.Template.Handlebars.revive({1:function(e,n,a,l,t){return"\t"+e.escapeExpression((a.outlet||n&&n.outlet||a.helperMissing).call(null!=n?n:{},null!=n?n["photo-well-scrappy-edit-view"]:n,{name:"outlet",hash:{},data:t}))+"\n"},3:function(e,n,a,l,t){return"\t"+e.escapeExpression((a.outlet||n&&n.outlet||a.helperMissing).call(null!=n?n:{},null!=n?n["fave-view"]:n,{name:"outlet",hash:{},data:t}))+"\n"},5:function(e,n,a,l,t){return"disabled"},7:function(e,n,a,l,t){var s,r=null!=n?n:{},i=a.helperMissing,o=e.escapeExpression;return'\t\t<a href="'+o("function"==typeof(s=null!=(s=a.downloadLink||(null!=n?n.downloadLink:n))?s:i)?s.call(r,{name:"downloadLink",hash:{},data:t}):s)+'" class="server-only-link" title="'+o((a.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.DOWNLOAD_THIS_VIDEO"},data:t}))+'">\n'},9:function(e,n,a,l,t){var s,r=null!=n?n:{},i=a.helperMissing,o=e.escapeExpression;return'\t\t<a href="'+o("function"==typeof(s=null!=(s=a.downloadLink||(null!=n?n.downloadLink:n))?s:i)?s.call(r,{name:"downloadLink",hash:{},data:t}):s)+'" title="'+o((a.intlMessage||n&&n.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.DOWNLOAD_THIS_PHOTO"},data:t}))+'">\n'},11:function(e,n,a,l,t){return'\t\t<div class="display-obscured-download-sizes">\n\t\t\t'+e.escapeExpression((a.renderTrustedMarkup||n&&n.renderTrustedMarkup||a.helperMissing).call(null!=n?n:{},null!=n?n.downloadItems:n,{name:"renderTrustedMarkup",hash:{},data:t}))+"\n\t\t</div>\n"},compiler:[7,">= 4.0.0"],main:function(e,n,a,l,t){var s,r=null!=n?n:{},i=a.helperMissing,o=e.escapeExpression;return(null!=(s=a.if.call(r,null!=n?n.viewerIsOwner:n,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.program(3,t,0),data:t}))?s:"")+"\n"+o((a.outlet||n&&n.outlet||i).call(r,null!=n?n["share-view"]:n,{name:"outlet",hash:{},data:t}))+'\n\n<div class="download '+(null!=(s=a.unless.call(r,null!=n?n.downloadingAvailable:n,{name:"unless",hash:{},fn:e.program(5,t,0),inverse:e.noop,data:t}))?s:"")+'">\n'+(null!=(s=a.if.call(r,null!=n?n.isVideo:n,{name:"if",hash:{},fn:e.program(7,t,0),inverse:e.program(9,t,0),data:t}))?s:"")+'\t\t\t<i class="ui-icon-download"></i>\n\t\t</a>\n\n'+(null!=(s=a.if.call(r,null!=n?n.downloadItems:n,{name:"if",hash:{},fn:e.program(11,t,0),inverse:e.noop,data:t}))?s:"")+"\n</div>\n\n"+o((a.outlet||n&&n.outlet||i).call(r,null!=n?n["photo-sidebar-toggle-view"]:n,{name:"outlet",hash:{},data:t}))+"\n"},useData:!0}),l={};e.Array.each([],function(n){var a=e.Template.get("hermes/"+n);a&&(l[n]=a)}),e.Template.register("hermes/photo-engagement",function(n,t){return t=t||{},t.partials=t.partials?e.merge(l,t.partials):l,a(n,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});